<!doctype html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Socket.IO chat</title>
    <link rel="stylesheet" type="text/css" href="normalize.css">
    <link rel="stylesheet" type="text/css" href="mainstyle.css">
  </head>
  <body>
    <canvas id="c" height="600" width="800">
    </canvas>

    <div class="main-div">
      <div class="title-div">
        <img src="images/xmas.jpg" class="image-xmas" alt="xmas" />
        <h2>ŚWIĄTECZNY CHAT</h2>
        <div class="music-buttons">
          <span>Wybierz piosenkę:</span>
          <button id="song1" class="tooltip">1<span class="tooltiptext">Jingle Bells</span></button>
          <button id="song2" class="tooltip">2<span class="tooltiptext">Maybe...</span></button>
          <button id="song3" class="tooltip">3<span class="tooltiptext">I Don't Want To Set The World On Fire</span></button>
          <button id="song4" class="tooltip">4<span class="tooltiptext">The End Of The World</span></button>
          <button id="song5" class="tooltip">5<span class="tooltiptext">Soooo bongo, bongo, bongo...</span></button>
        </div>
      </div>
      <div class="user-list-div">
        <ul id="users-list"></ul>
      </div>
      <div class="messages-div">
        <div id="chat-div"></div>
      </div>
    </div> 
      
    <form action="" id="message-form">
        <div class="input-group">
          <span id="message_name" class="input-group-label"></span>
          <span class="separator"><input type="text" id="message_input" class="form-input" autocomplete="off" placeholder="Wiadomość"/></span>
          <button type="submit" style="display:none">Wyślij</button>
        </div>
    </form>
    

    <script src="socket.io/socket.io.js"></script>
    <script src="jquery-3.2.1.min.js"></script>
    <script src="client.js"></script>
    <script src="snow.js"></script>

    <script>
      $(function() {

          function playSound() {
            
            // SWITCH BETWEEN LOCALHOST AND REMOTE SERVER
            
            var serverType = null;
            if (window.location.href.startsWith("http://localhost")) {
              serverType = 'http://localhost:9000/';
            } else {
              serverType = 'http://vps.wroblewskipiotr.pl:9000/';
            }

            var audioSong1 = serverType+'song1';
            var audioSong2 = serverType+'song2';
            var audioSong3 = serverType+'song3';
            var audioSong4 = serverType+'song4';
            var audioSong5 = serverType+'song5';

            var audio = new Audio(audioSong1);
            audio.loop = true;
            audio.play();
            var currentSong = 1;
            console.log('Playing song '+currentSong);

            var playSong = function(song) {
              console.log('Playing song '+song);
              audio.pause();
              switch(song) {
                case 2: {
                  audio = new Audio(audioSong2);
                  break;
                }
                case 3: {
                  audio = new Audio(audioSong3);
                  break;
                }
                case 4: {
                  audio = new Audio(audioSong4);
                  break;
                }
                case 5: {
                  audio = new Audio(audioSong5);
                  break;
                }
                default: {
                  audio = new Audio(audioSong1);
                  break;
                }
              }
              audio.loop = true;
              audio.play();
            };

            $('#song1').click(function() {
              if (currentSong !== 1) {
                currentSong = 1;
                playSong(currentSong);
              } else {
                console.log('Song '+currentSong +' paused.');
                currentSong = 0;
                audio.pause();
              }
            });

            $('#song2').click(function() {
              if (currentSong !== 2) {
                currentSong = 2;
                playSong(currentSong);
              } else {
                console.log('Song '+currentSong +' paused.');
                currentSong = 0;
                audio.pause();
              }
            });

            $('#song3').click(function() {
              if (currentSong !== 3) {
                currentSong = 3;
                playSong(currentSong);
              } else {
                console.log('Song '+currentSong +' paused.');
                currentSong = 0;
                audio.pause();
              }
            });

            $('#song4').click(function() {
              if (currentSong !== 4) {
                currentSong = 4;
                playSong(currentSong);
              } else {
                console.log('Song '+currentSong +' paused.');
                currentSong = 0;
                audio.pause();
              }
            });

            $('#song5').click(function() {
              if (currentSong !== 5) {
                currentSong = 5;
                playSong(currentSong);
              } else {
                console.log('Song '+currentSong +' paused.');
                currentSong = 0;
                audio.pause();
              }
            });
        };

        //playSound();
      }
    );
    </script>
  </body>
</html>